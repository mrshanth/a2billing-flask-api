/*! https://github.com/tamble/jquery-ui-daterangepicker
 * Copyright (c) 2014 Tamble, Inc. Licensed MIT
 */

(function(b,D,Q){function M(e,a,f){function g(a){c.button("option","label",a)}var c,d;d="drp_autogen"+w++;b('label[for="'+e.attr("id")+'"]').attr("for",d);c=b('<button type="button"></button>').addClass(a+"-triggerbutton").attr({title:e.attr("title"),tabindex:e.attr("tabindex"),id:d}).button({icons:{secondary:f.icon},label:f.initialText});return{getElement:function(){return c},getLabel:function(){return c.button("option","label")},setLabel:g,reset:function(){e.val({start:null,end:null}).change();
g(f.initialText)}}}function N(e,a,f){var g,c;(function(){g=b("<div></div>").addClass(e+"-presets");c=b("<ul></ul>");b.each(a.presetRanges,function(){b('<li><a href="#">'+this.text+"</a></li>").data("dateStart",this.dateStart).data("dateEnd",this.dateEnd).click(f).appendTo(c)});g.append(c);c.menu().data("ui-menu").delay=0})();return{getElement:function(){return g}}}function O(e,a){function f(){setTimeout(function(){g();f()},moment().endOf("day")-moment())}function g(){c.datepicker("refresh");c.datepicker("setDate",
null)}var c,d={start:null,end:null};c=b("<div></div>",{"class":e+"-calendar ui-widget-content"});c.datepicker(b.extend({},a.datepickerOptions,{beforeShowDay:function(b){var c=[!0,d.start&&(+b===+d.start||d.end&&d.start<=b&&b<=d.end)?"ui-state-highlight":""],f=[!0,""];a.datepickerOptions.hasOwnProperty("beforeShowDay")&&(f=a.datepickerOptions.beforeShowDay(b));return[c[0]&&f[0],c[1]+f[1]]},onSelect:function(c,f){var e=b.datepicker.parseDate(a.datepickerOptions.dateFormat||b.datepicker._defaults.dateFormat,
c);!d.start||d.end?(d.start=e,d.end=null):e<d.start?(d.end=d.start,d.start=e):d.end=e;if(a.datepickerOptions.hasOwnProperty("onSelectDay"))a.datepickerOptions.onSelectDay(c,f)}}));f();return{getElement:function(){return c},scrollToRangeStart:function(){d.start&&c.datepicker("setDate",d.start)},getRange:function(){return d},setRange:function(a){d=a;g()},refresh:g,reset:function(){d={start:null,end:null};g()}}}function P(e,a,f){var g,c;c=b('<button type="button" class="ui-priority-primary"></button>').text(a.applyButtonText).button();
a=b('<button type="button" class="ui-priority-secondary"></button>').text(a.cancelButtonText).button();g=b("<div></div>").addClass(e+"-buttonpanel").append(c).append(a);f&&(c.click(f.onApply),a.click(f.onCancel));return{getElement:function(){return g}}}function z(e,a){function f(){if(a.autoFitCalendars){var p=b(D).width(),h=k.outerWidth(!0),c=q.getElement(),d=c.datepicker("option","numberOfMonths"),e=d;if(h>p){for(;1<d&&k.outerWidth(!0)>p;)c.datepicker("option","numberOfMonths",--d);d!==e&&(f.monthWidth=
(h-k.outerWidth(!0))/(e-d))}else for(;d<f.numberOfMonths&&p-k.outerWidth(!0)>=f.monthWidth;)c.datepicker("option","numberOfMonths",++d);F();A=!1}}function g(){m.getElement().click(G);m.getElement().keydown(z);u.click(n);b(D).resize(function(){r?f():A=!0})}function c(p){var h=a.dateFormat;return b.datepicker.formatDate(h,p.start)+(+p.end!==+p.start?a.rangeSplitter+b.datepicker.formatDate(h,p.end):"")}function d(p){var h=a.altFormat,c={};c.start=b.datepicker.formatDate(h,p.start);c.end=b.datepicker.formatDate(h,
p.end);return JSON.stringify(c)}function E(c){var h=a.altFormat,d=null;if(c)try{d=JSON.parse(c,function(a,c){return a?b.datepicker.parseDate(h,c):c})}catch(e){}return d}function x(){var a=E(e.val());a?(m.setLabel(c(a)),q.setRange(a)):q.reset()}function y(b){var h=b||q.getRange();if(h.start&&(h.end||(h.end=h.start),b&&q.setRange(h),m.setLabel(c(h)),e.val(d(h)).change(),a.onChange))a.onChange()}function w(){var c=b(this),d=c.data("dateStart")().startOf("day").toDate(),c=c.data("dateEnd")().startOf("day").toDate();
q.setRange({start:d,end:c});a.applyOnMenuSelect&&(n(),y());return!1}function F(){k.position({my:"left top",at:"left bottom"+(0>a.verticalOffset?a.verticalOffset:"+"+a.verticalOffset),of:m.getElement(),collision:"flipfit flipfit",using:function(c,b){var d=s,e,f=b.element.top+b.element.height/2,g=b.target.top+b.target.height/2,n=t;s=b.element.left+b.element.width/2>b.target.left+b.target.width/2?H:I;s!==d&&(a.mirrorOnCollision&&(e=s===I?B:q,k.children().first().append(e.getElement())),k.removeClass(l+
"-"+v[d]),k.addClass(l+"-"+v[s]));k.css({left:c.left,top:c.top});t=f>g?J:K;t!==n&&(null!==n&&m.getElement().removeClass(l+"-"+v[n]),m.getElement().addClass(l+"-"+v[t]));d=t===J&&b.element.top-b.target.top!==b.target.height+a.verticalOffset||t===K&&b.target.top-b.element.top!==b.element.height+a.verticalOffset;m.getElement().toggleClass(l+"-vfit",d)}})}function z(a){switch(a.which){case b.ui.keyCode.UP:case b.ui.keyCode.DOWN:a.preventDefault();a.stopPropagation();C();break;case b.ui.keyCode.ESCAPE:a.preventDefault();
a.stopPropagation();n();break;case b.ui.keyCode.TAB:n()}}function C(){r||(m.getElement().addClass(l+"-active"),u.show(),r=!0,A&&f(),q.scrollToRangeStart(),k.show(),F());if(a.onOpen)a.onOpen()}function n(){r&&(k.hide(),u.hide(),m.getElement().removeClass(l+"-active"),r=!1);if(a.onClose)a.onClose()}function G(){r?n():C()}var l="comiseo-daterangepicker",k,u,m,B,q,L,r=!1,A=!1,I=0,H=1,K=2,J=3,v=["left","right","top","bottom"],s=H,t=null;(function(){m=M(e,l,a);B=N(l,a,w);q=O(l,a);f.numberOfMonths=a.datepickerOptions.numberOfMonths;
f.numberOfMonths instanceof Array&&(a.autoFitCalendars=!1);L=P(l,a,{onApply:function(){n();y()},onCancel:function(){n();x()}});k=b("<div></div>",{"class":l+" "+l+"-"+v[s]+" ui-widget ui-widget-content ui-corner-all ui-front"}).append(b("<div></div>",{"class":l+"-main ui-widget-content"}).append(B.getElement()).append(q.getElement())).append(b('<div class="ui-helper-clearfix"></div>').append(L.getElement())).hide();e.hide().after(m.getElement());u=b("<div></div>",{"class":"ui-front "+l+"-mask"}).hide();
b("body").append(u).append(k);f();x();g()})();return{toggle:G,destroy:function(){k.remove();m.getElement().remove();e.show()},open:C,close:n,setRange:y,getRange:function(){return E(e.val())},clearRange:function(){m.reset();q.reset()},reset:x,getContainer:function(){return k}}}var w=0;b.widget("comiseo.daterangepicker",{version:"0.3.2",options:{presetRanges:[{text:"Today",dateStart:function(){return moment()},dateEnd:function(){return moment()}},{text:"Yesterday",dateStart:function(){return moment().subtract("days",
1)},dateEnd:function(){return moment().subtract("days",1)}},{text:"Last 7 Days",dateStart:function(){return moment().subtract("days",6)},dateEnd:function(){return moment()}},{text:"Last Week (Mo-Su)",dateStart:function(){return moment().subtract("days",7).isoWeekday(1)},dateEnd:function(){return moment().subtract("days",7).isoWeekday(7)}},{text:"Month to Date",dateStart:function(){return moment().startOf("month")},dateEnd:function(){return moment()}},{text:"Previous Month",dateStart:function(){return moment().subtract("month",
1).startOf("month")},dateEnd:function(){return moment().subtract("month",1).endOf("month")}},{text:"Year to Date",dateStart:function(){return moment().startOf("year")},dateEnd:function(){return moment()}}],verticalOffset:0,initialText:"Select date range...",icon:"ui-icon-triangle-1-s",applyButtonText:"Apply",cancelButtonText:"Cancel",rangeSplitter:" - ",dateFormat:"M d, yy",altFormat:"yy-mm-dd",mirrorOnCollision:!0,applyOnMenuSelect:!0,autoFitCalendars:!0,onOpen:null,onClose:null,onChange:null,datepickerOptions:{numberOfMonths:3,
maxDate:0}},_create:function(){this._dateRangePicker=z(this.element,this.options)},_destroy:function(){this._dateRangePicker.destroy()},open:function(){this._dateRangePicker.open()},close:function(){this._dateRangePicker.close()},setRange:function(b){this._dateRangePicker.setRange(b)},getRange:function(){return this._dateRangePicker.getRange()},clearRange:function(){this._dateRangePicker.clearRange()},widget:function(){return this._dateRangePicker.getContainer()}})})(jQuery,window);
